---
title: Practical Pentest Labs | Rey
date: 2018-07-03 00:00:00 +0000
layout: post
categories: []
image:
  feature: assets/img/06e6e8d7d89aaabdc1a0aab7476d717a.jpg
  credit: ''
  creditlink: ''
description: ''
---
This post will describe exploitation of the Rey device on [PracticalPenTestLabs](https://practicalpentestlabs.com/).

## Enumeration

As is tradition, we run a full nmap scan:

```bash
nmap -p80 -A 10.0.2.20
Starting Nmap 7.70 ( https://nmap.org ) at 2018-07-04 11:34 EDT
Nmap scan report for 10.0.2.20
Host is up (0.092s latency).

PORT   STATE SERVICE VERSION
80/tcp open  http    Easy File Sharing Web Server httpd 6.9
| http-cookie-flags: 
|   /: 
|     SESSIONID: 
|_      httponly flag not set
|_http-server-header: Easy File Sharing Web Server v6.9
|_http-title: Login - powered by Easy File Sharing Web Server
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Aggressive OS guesses: FreeBSD 6.1-RELEASE (87%), IBM AIX 6.1 (86%), Ricoh Aficio SP C210SF printer (85%), Apple Mac OS X 10.3.9 (Panther) (Darwin 7.9.0, PowerPC) (85%), FreeBSD 5.5-STABLE (85%), Microsoft Windows Server 2003 SP2 (85%), Microsoft Windows XP (85%), IBM AIX 5.3 (85%), IBM AIX 7.1 (85%), Sony Bravia V5500-series TV (85%)
No exact OS matches for host (test conditions non-ideal).
Network Distance: 3 hops
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

TRACEROUTE (using port 443/tcp)
HOP RTT      ADDRESS
1   92.39 ms 10.10.0.1
2   ...
3   92.14 ms 10.0.2.20

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 34.13 seconds
```

This one is going to be a very quick one, frankly. I am not sure if this machine was supposed to be exploited this way but... As you can see from our Nmap scan we get one port back which is port 80. Using the -A flag gives us more information on the port and from this we can see that there is a program called "Easy File Sharing Web Server httpd 6.9" running. This is good, so we know that is we visit this webpage we will more than likely be able to view files.

![](/assets/img/Screenshot from 2018-07-04 11-30-13.jpg)

Visiting the HTTP page give us a login page. Hmm... how can we gain credentials? Wait... if we take another look there is a option called "Login as a Guest". Let's try that.

![](/assets/img/Screenshot from 2018-07-04 11-30-16.jpg)

Boom! we're in. Unfortunately for the admin, they didn't configure this application properly so even a guest user can access any files on the system. Now we could browse Exploit-DB and locate a exploit that would grant us remote access but for this CTF there is no need.

![](/assets/img/Screenshot from 2018-07-04 11-33-59.jpg)

We capture the secret.txt flag and call this one complete.