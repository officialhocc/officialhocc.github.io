---
title: Practical Pentest Labs | Vader
date: 2018-07-03 00:00:00 +0000
layout: post
categories: []
image:
  feature: assets/img/a84c052d30f2803b4ff58d75a83572ea.jpg
  credit: ''
  creditlink: ''
description: ''
---
This post will describe exploitation of the Winton device on [PracticalPenTestLabs](https://practicalpentestlabs.com/).

## Enumeration

As is tradition, we run a full nmap scan:

```bash
nmap -O -A -Pn  10.0.1.13
Starting Nmap 7.70 ( https://nmap.org ) at 2018-07-04 11:40 EDT
Nmap scan report for 10.0.1.13
Host is up (0.091s latency).
Not shown: 996 closed ports
PORT    STATE SERVICE      VERSION
80/tcp  open  http         Zervit httpd 0.4
|_http-server-header: Zervit 0.4
|_http-title: Site doesn't have a title (text/html).
135/tcp open  msrpc        Microsoft Windows RPC
139/tcp open  netbios-ssn  Microsoft Windows netbios-ssn
445/tcp open  microsoft-ds Windows XP microsoft-ds
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.70%E=4%D=7/4%OT=80%CT=1%CU=39501%PV=Y%DS=2%DC=T%G=Y%TM=5B3CEB7E
OS:%P=x86_64-pc-linux-gnu)SEQ(SP=105%GCD=1%ISR=10B%TI=I%CI=I%TS=0)OPS(O1=M5
OS:48NW0NNT00NNS%O2=M548NW0NNT00NNS%O3=M548NW0NNT00%O4=M548NW0NNT00NNS%O5=M
OS:548NW0NNT00NNS%O6=M548NNT00NNS)WIN(W1=FD80%W2=FD80%W3=FC80%W4=FB40%W5=FB
OS:40%W6=FB8B)ECN(R=Y%DF=Y%T=80%W=FD80%O=M548NW0NNS%CC=N%Q=)T1(R=Y%DF=Y%T=8
OS:0%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=N%T=80%W=0%S=A%A=O%F=R%O
OS:=%RD=0%Q=)T5(R=Y%DF=N%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=N%T=80
OS:%W=0%S=A%A=O%F=R%O=%RD=0%Q=)T7(R=N)U1(R=Y%DF=N%T=80%IPL=B0%UN=0%RIPL=G%R
OS:ID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=N)

Network Distance: 2 hops
Service Info: OSs: Windows, Windows XP; CPE: cpe:/o:microsoft:windows, cpe:/o:microsoft:windows_xp

Host script results:
|_clock-skew: mean: 3h21m39s, deviation: 4h56m59s, median: -8m20s
|_nbstat: NetBIOS name: VADER-, NetBIOS user: <unknown>, NetBIOS MAC: 00:0c:29:32:31:51 (VMware)
| smb-os-discovery: 
|   OS: Windows XP (Windows 2000 LAN Manager)
|   OS CPE: cpe:/o:microsoft:windows_xp::-
|   Computer name: VADER-
|   NetBIOS computer name: VADER-\x00
|   Workgroup: MSHOME\x00
|_  System time: 2018-07-04T08:32:31-07:00
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
|_smb2-time: Protocol negotiation failed (SMB2)

TRACEROUTE (using port 53/tcp)
HOP RTT      ADDRESS
1   92.45 ms 10.10.0.1
2   92.96 ms 10.0.1.13

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 271.57 seconds
```

This one is going to be a very quick one, frankly. I am not sure if this machine was supposed to be exploited this way but... As you can see from our Nmap scan we get a few ports back. The most surprising thing is that this machine is running Windows 2000. So the first thing that came to mind was... "Hey, let's run some SMB script via Nmap"

```bash
 nmap --script vuln  10.0.1.13
Starting Nmap 7.70 ( https://nmap.org ) at 2018-07-04 11:45 EDT
Nmap scan report for 10.0.1.13
Host is up (0.095s latency).
Not shown: 997 closed ports
PORT    STATE SERVICE
135/tcp open  msrpc
139/tcp open  netbios-ssn
445/tcp open  microsoft-ds

Host script results:
| smb-vuln-ms08-067: 
|   VULNERABLE:
|   Microsoft Windows system vulnerable to remote code execution (MS08-067)
|     State: LIKELY VULNERABLE
|     IDs:  CVE:CVE-2008-4250
|           The Server service in Microsoft Windows 2000 SP4, XP SP2 and SP3, Server 2003 SP1 and SP2,
|           Vista Gold and SP1, Server 2008, and 7 Pre-Beta allows remote attackers to execute arbitrary
|           code via a crafted RPC request that triggers the overflow during path canonicalization.
|           
|     Disclosure date: 2008-10-23
|     References:
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4250
|_      https://technet.microsoft.com/en-us/library/security/ms08-067.aspx
|_smb-vuln-ms10-054: false
|_smb-vuln-ms10-061: false
| smb-vuln-ms17-010: 
|   VULNERABLE:
|   Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010)
|     State: VULNERABLE
|     IDs:  CVE:CVE-2017-0143
|     Risk factor: HIGH
|       A critical remote code execution vulnerability exists in Microsoft SMBv1
|        servers (ms17-010).
|           
|     Disclosure date: 2017-03-14
|     References:
|       https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/
|       https://technet.microsoft.com/en-us/library/security/ms17-010.aspx
|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143
|_smb-vuln-regsvc-dos: ERROR: Script execution failed (use -d to debug)

Nmap done: 1 IP address (1 host up) scanned in 64.88 seconds
```

And surprise, surprise as expected this machine is more than likely vulnerable to MS08-067. Easy. So let's fire up Metasploit, load MS08-067 and exploit this machine.

![](/assets/img/Screenshot from 2018-07-04 11-47-14.jpg)

And once executed, we gain a root shell and capture our flag.

![](/assets/img/Screenshot from 2018-07-04 11-47-49.jpg)